---
layout: post
title: TP2 Building websites using Javascript
subtitle: Deuxième TP
tags: [Web Avancé, HTML, CSS, Javascript, Node JS]
author: Mariem ZAOUALI
---

# TP 2 : Créer une application avec Javascript avec Node.JS et Express
À la fin de ce TP, vous aurez une meilleure compréhension de la création d'une application avec Javascript, Express et Node.JS en interagissant avec une base de données, ainsi que de l'architecture front-end et back-end des applications Web. Vous saurez également comment créer une application Web avec JavaScript qui effectue des opérations CRUD. Avant de commencer ce cours, vous devez avoir des connaissances générales sur le HTML, le CSS, le développement Web, les technologies Web et une compréhension de base de JavaScript.


## Outils à utiliser

- Un éditeur : **Visual Studio Code**. Après son installation, choisissez **"Auto Save"** dans le menu **File** pour assurer l'enregistrement automatique des changements au niveau du code.
- **Live Server** : Installer le serveur à partir de visual code
- Un navigateur

## Architecture de l'application

Nous allons dans ce TP, créer une application qui génère des citations d'une manière aléatoire. Nous pouvons également ajouter de nouvelles citations ou encore
lister celles déjà existantes dans une base de données. L'architecture de cette application sera donc composée de trois parties.
* Une partie Front pour communiquer ou lire les citations.
* Une partie API qui servira le trait d'union entre le front et la base de données. On peut qualifier cette partie comme étant la logique métier de notre application
* Une partie dédiée à la persistance des données.
(( A définir )) 
((Arborescence de l'application))

## Créer votre projet sur VS code

Ouvrez votre VS code et sélectionnez un nouveau dossier où vous allez créer votre application. Ouvrez le terminal et choisissez le prompt **Git bash** pour taper la commande suivante. Cette commande va vous créer l'arborescence ciblée pour notre projet ainsi que la création des fichiers vides.

```
sudo -s mkdir -p app/{config,features/{addquote,quotelist},views} && touch "app/index.js" "app/apiserver.js"
"app/config/dbinfo.js" "app/views/index.html" "app/features/addquote/addquote.html" "app/features/addquote/addquote.js"
"app/features/quotelist/quotelist.html" "app/features/quotelist/quotelist.js"
```
Tapez par la suite dans le même terminal, la commande suivante pour initier le **runtime** Node.JS pour notre application JS. C'est l'environnement qui
nous permettra d'exécuter le code écrit en JS. Suite à cette exécution, on va vous demander d'entrer des informations sur votre application. Vous pourvez ne pas 
tout remplir, mais au moins vous mettez le nom du projet comme Quotes et vous spécifier la page `index.html` est votre entry-point.

```
npm init
```
## La première ossature des pages HTML

Nous créons, dans cette section, la structure des pages html de notre application. Veuillez copier le code de chaque cellule dans la page adéquate:
`index.html`
```html
<!DOCTYPE html>
<html>

<head>
    <title>Quotes for life</title>
</head>

<body> <!-- Call the function on page load -->
    <h1>Quotes</h1>
    <div></div>




    <footer>
        <Center>
        <p>&copy; Ecole Nationale d'Ingénieurs de Tunis - TP2 Dev web avancé</p>
        </Center>
      </footer>
</body>

</html>
```
`addquote.html`

```html
<!DOCTYPE html>
<html>
<head>
  <title>Add Quotes</title>
</head>
<body>
  <div class="container">
    <h1>Add a quote</h1>
    
  </div>
  <br>
  <br>
  <div class="container"></div>
    <center><a href="/app/views/index.html" class="btn btn-primary">Home</a></center>
  </div>
  <footer>
    <Center>
        <p>&copy; Ecole Nationale d'Ingénieurs de Tunis - TP2 Dev web avancé</p>
    </Center>
  </footer>

</body>
</html>
```
`quotelist.html`

```html
<!DOCTYPE html>
<html>
<head>
  <title>Quotes List</title>
</head>
<body>
  <div>
    <h1>Quotes List</h1>
  </div>

  <br>
  <br>
  <div class="container"></div>
    <center><a href="/app/views/index.html" class="btn btn-primary">Home</a></center>
  </div>
  <script>
    //Function to list the quotes
  </script>

  <br>
  <br>
  <footer>
    <Center>
        <p>&copy; Ecole Nationale d'Ingénieurs de Tunis - TP2 Dev web avancé</p>
    </Center>
  </footer>

</body>
</html>
```

## Ajout des formulaires 

Maintenant, nous ajouterons à la page `addquote.html`, un petit formulaire qui va nous permettre de saisir une nouvelle citation selon le domaine (motivation,
inspiration, amitié etc). A l'intérieur de body, dans la première div, ajoutons ce contenu:
```html
<div class="container"></div>
  <h1>Add a Quote</h1>
  <form id="add-quote-form" action="/quotes" method="POST">
    <div class="form-group">
      <label for="domain">Domain</label>
      <input type="text" class="form-control" id="question" name="question" required>
    </div>
    <div class="form-group">
      <label for="content">Content</label>
      <input type="text" class="form-control" id="answer" name="answer" required>
    </div>
    <div class="form-group">
      <label for="rating">Rating</label>
      <input type="number" class="form-control" id="rating" name="rating" min="1" max="5" required>
    </div>
    <button type="submit" class="btn btn-primary">Add Quote</button>
  </form>
</div>
```

Dans le fichier `quotelist.js`, insérez le code suivant:

```html
// Quote List feature JavaScript code
// quotelist.js

// Function to display all quotes
function displayQuotes() {
    fetch('/japi/quotes')
      .then(response => response.json())
      .then(data => {
        const quoteList = document.getElementById('quote-list');
        quoteList.innerHTML = '';
  
        data.forEach(quote => {
          const listItem = document.createElement('li');
          listItem.className = 'list-group-item';
          listItem.innerHTML = `
            <strong>Domain:</strong> ${quote.domain}<br>
            <strong>Content:</strong> ${quote.content}<br>
            <strong>Rating:</strong> ${quote.rating}<br>
            <button class="btn btn-sm btn-primary" onclick="editQuote(${quote.id})">Edit</button>
            <button class="btn btn-sm btn-danger" onclick="deleteQuote(${quote.id})">Delete</button>
          `;
          quoteList.appendChild(listItem);
        });
      })
      .catch(error => console.log(error));
  }
```
Améliorant nos pages avec du CSS. Pour ce faire, nous aurons recours au Bootstrap qui est un framework de développement front-end.
Au niveau de la bailse head de la page `index.html`, ajoutons ce contenu :
```html
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    body {
      background-color: purple;
    }

    .jumbotron {
      background-color: gold;
    }
  </style>
```
## Notre première intéraction en JS
